import axios from 'axios';
import Cookies from 'js-cookie'; // Make sure to install js-cookie if you haven't already

const axiosConnect = axios.create({
  // baseURL, timeout, etc.
});

const loadFileSpaceData = () => {
  const token = Cookies.get('token'); // Get the token from the cookie

  axiosConnect
    .get("/getFileData2", {
      params: {
        fileName: "SYSSHR.ZOOPS.TEST(TEST)",
      },
      headers: {
        "Access-Control-Allow-Origin": "*", // Replace * with your allowed origins
        "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
        "Access-Control-Allow-Headers":
          "Origin, X-Requested-With, Content-Type, Accept, Authorization", // Add more headers if needed
        "Authorization": `Bearer ${token}` // Add the token here
      },
    })
    .then((response) => {
      console.log("Data received from getFileSpaceData: " + response.data);
      if (response.data === 1) {
        axiosConnect
          .get("/getFileData2", {
            params: {
              fileName: "SYSSHR.ZOOPS.FILES(GBSJSON)",
            },
            headers: {
              "Access-Control-Allow-Origin": "*", // Replace * with your allowed origins
              "Access-Control-Allow-Methods":
                "GET, POST, PUT, DELETE, OPTIONS",
              "Access-Control-Allow-Headers":
                "Origin, X-Requested-With, Content-Type, Accept, Authorization", // Add more headers if needed
              "Authorization": `Bearer ${token}` // Add the token here
            },
          })
          .then((response) => {
            console.log(response);
            console.log(
              "Data received from getFileSpaceData: " + response.data
            );
            const jsonObject1 = response.data.replace(/\s/g, "");
            const jsonObject = JSON.parse(jsonObject1);
            console.log(jsonObject);
            setJsonData(jsonObject);
          })
          .catch((err) => {
            console.log(err);
          });

        axiosConnect
          .post("/saveSingleFile", {
            fileName: "SYSSHR.ZOOPS.TEST(TEST)",
            fileContent: "0",
          }, {
            headers: {
              "Authorization": `Bearer ${token}` // Add the token here
            },
          })
          .then((response) => {
            console.log("wrted to test");
            console.log(response);
          })
          .catch((err) => {
            console.log(err);
          });
      }
    })
    .catch((err) => {
      console.log(err);
    });
};
