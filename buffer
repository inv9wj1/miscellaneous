       IDENTIFICATION DIVISION.
       PROGRAM-ID. MPDENCR1.

       DATA DIVISION.
       WORKING-STORAGE SECTION.

       01  WS-DATA.
           05  DATA-LENGTH       PIC 9(08) COMP VALUE 07.
           05  DATA-VALUE        PIC X(07) VALUE 'FDMWCZ7'.

       01  WS-KEY.
           05  KEY-LENGTH        PIC 9(08) COMP VALUE 8.
           05  KEY-VALUE         PIC X(08) VALUE '12345678'.

       01  WS-ENCRYPTED-DATA.
           05  ENCD-DATA-LENGTH  PIC 9(08) COMP VALUE 07.
           05  ENCD-DATA-VALUE   PIC X(07).
      *    05  ENCD-DATA-VALUE   PIC X(16).

       01  WS-RETURN-CODE        PIC S9(04) COMP.
       01  WS-REASON-CODE        PIC S9(08) COMP.
       01  WS-RULES              PIC X(8) VALUE 'ECBPCS  '.

       01  WS-ERR-TEXT           PIC X(60).

       LINKAGE SECTION.
       01  WORK-AREA.
           05  WA-RC             PIC S9(04) COMP.
           05  WA-RSN            PIC S9(08) COMP.
           05  WA-RS             PIC X(8).

       PROCEDURE DIVISION.

       MAIN-PROCESS SECTION.
           DISPLAY 'Starting the Encryption Process'.

           CALL 'CSNBENC' USING
                 BY REFERENCE   DATA-LENGTH
                 BY REFERENCE   DATA-VALUE
                 BY REFERENCE   KEY-LENGTH
                 BY REFERENCE   KEY-VALUE
                 BY REFERENCE   ENCD-DATA-LENGTH
                 BY REFERENCE   ENCD-DATA-VALUE
                 BY REFERENCE   WS-RETURN-CODE
                 BY REFERENCE   WS-REASON-CODE.

           IF WS-RETURN-CODE NOT = 0
              DISPLAY 'Encryption Failed.'
              MOVE 'ERROR: RETURN CODE IS: ' TO WS-ERR-TEXT ( 1:23 )
              MOVE WS-RETURN-CODE TO WS-ERR-TEXT (24:4 )
              DISPLAY WS-ERR-TEXT
              MOVE 'REASON CODE IS: ' TO WS-ERR-TEXT (1:07)
              MOVE WS-REASON-CODE TO WS-ERR-TEXT (08:8)
              DISPLAY WS-ERR-TEXT
              STOP RUN
           ELSE
              DISPLAY 'DATA TO ENCRYPT ' DATA-VALUE
              DISPLAY 'Encryption Successful.'
              DISPLAY 'Encrypted Data: ' ENCD-DATA-VALUE
           END-IF.

           DISPLAY 'End of Encryption Process'.
           STOP RUN.
       END-MAIN-PROCESS.
