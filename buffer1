async function createSession() {
const currentTime = Date.now();

if (
!ltpaToken ||
(tokenExpirationTime && currentTime >= tokenExpirationTime)
) {
console.log("LTPA token expired or not found, obtaining a new token.");
await getLtpaToken();
}

const profInfo = new ProfileInfo("zowe");
await profInfo.readProfilesFromDisk();
const zosmfProfAttrs = profInfo.getDefaultProfile("zosmf");
const zosmfMergedArgs = profInfo.mergeArgsForProfile(zosmfProfAttrs, {
getSecureVals: true,
});
const session = imperative.ProfileInfo.createSession(
zosmfMergedArgs.knownArgs
);

// Specify LTPA token type and value on the session object.
session.ISession.tokenType = "ltpaToken";
session.ISession.tokenValue = ltpaToken;

return session;
}
